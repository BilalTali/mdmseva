import{u as E,j as e,H as C,L as p}from"./app-DHCAgeO8.js";import{A as k}from"./AuthenticatedLayout-dBQysIGU.js";import"./ApplicationLogo-Da_2dMoK.js";import"./transition-jgp50ovQ.js";import"./createLucideIcon-DQAdNBRm.js";import"./send-BtT_p_gw.js";function L({auth:b,academic_years:y=[],classes:j=[],user_udise:n="",school_name:x="",school_type:f="",existing_statement:d=null}){const r=!!d,m=(()=>{const t={primary:["kg","1","2","3","4","5"],middle:["kg","1","2","3","4","5","6","7","8"],secondary:["6","7","8","9","10"],senior_secondary:["6","7","8","9","10","11","12"]}[f]||[];return j.filter(l=>t.includes(l.value))})(),N=()=>{if(d&&d.entries){const s={};return d.entries.forEach(t=>{s[t.class]={boys:t.boys,girls:t.girls}}),m.map(t=>({class:t.value,class_label:t.label,boys:s[t.value]?.boys||0,girls:s[t.value]?.girls||0}))}return m.map(s=>({class:s.value,class_label:s.label,boys:0,girls:0}))},{data:a,setData:c,post:v,put:w,processing:g,errors:i}=E({date:d?.date||"",udise:n,academic_year:d?.academic_year||"",is_bulk:!0,entries:N()}),u=(s,t,l)=>{const h=[...a.entries];h[s][t]=parseInt(l)||0,c("entries",h)},S=s=>{if(s.preventDefault(),a.entries.filter(l=>l.boys>0||l.girls>0).length===0){alert("Please enter student counts for at least one class");return}({...a},r?w(route("roll-statements.update",d.id),{preserveScroll:!0,onError:l=>{console.error("Update errors:",l)}}):v(route("roll-statements.store"),{preserveScroll:!0,onError:l=>{console.error("Store errors:",l)}}))},o=a.entries.reduce((s,t)=>({boys:s.boys+t.boys,girls:s.girls+t.girls,total:s.total+t.boys+t.girls}),{boys:0,girls:0,total:0});return a.entries.filter(s=>s.boys+s.girls>0).length,e.jsxs(k,{user:b.user,children:[e.jsx(C,{title:r?"Edit Roll Statement":"Create Roll Statement"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-4",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r?"Edit Roll Statement":"Create Roll Statement"}),x&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[x," â€¢ UDISE: ",n]}),r&&e.jsx("span",{className:"inline-flex mt-1 items-center px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:"Edit Mode - Date & Year Locked"})]}),e.jsx("div",{className:"flex-grow max-w-2xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:a.date,onChange:s=>c("date",s.target.value),disabled:r,className:`w-full rounded-md shadow-sm border-gray-300 text-sm ${r?"bg-gray-100 cursor-not-allowed":""}`,required:!0}),i.date&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Academic Year ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:a.academic_year,onChange:s=>c("academic_year",s.target.value),disabled:r,className:`w-full rounded-md shadow-sm border-gray-300 text-sm ${r?"bg-gray-100 cursor-not-allowed":""}`,required:!0,children:[e.jsx("option",{value:"",children:"Select Academic Year"}),y.map(s=>e.jsx("option",{value:s,children:s},s))]}),i.academic_year&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.academic_year})]})]})}),e.jsx(p,{href:route("roll-statements.index"),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-medium whitespace-nowrap self-start",children:"View All Records"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6 flex flex-col",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Student Enrollment"}),e.jsx("div",{className:"space-y-2 flex-grow overflow-y-auto",style:{maxHeight:"calc(100vh - 350px)"},children:a.entries.map((s,t)=>e.jsx("div",{className:`border rounded-lg p-2 ${s.boys+s.girls>0?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.class_label}),e.jsx("input",{type:"number",placeholder:"Boys",value:s.boys,onChange:l=>u(t,"boys",l.target.value),min:"0",className:"w-full rounded-md shadow-sm border-gray-300 text-sm py-1"}),e.jsx("input",{type:"number",placeholder:"Girls",value:s.girls,onChange:l=>u(t,"girls",l.target.value),min:"0",className:"w-full rounded-md shadow-sm border-gray-300 text-sm py-1"})]})},t))})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(p,{href:route("roll-statements.index"),className:"px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:S,disabled:g||o.total===0,className:"px-6 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Saving...":r?"Update Statement":"Save Statement"})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6 sticky top-6 flex flex-col",style:{maxHeight:"calc(100vh - 200px)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Roll Statement Preview"}),a.academic_year&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:a.academic_year})]}),e.jsx("div",{className:"space-y-2 flex-grow overflow-y-auto",children:a.entries.filter(s=>s.boys+s.girls>0).length>0?a.entries.filter(s=>s.boys+s.girls>0).map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-3 bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.class_label}),e.jsxs("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded font-medium",children:["Total: ",s.boys+s.girls]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded p-2 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Boys"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:s.boys})]}),e.jsxs("div",{className:"bg-white rounded p-2 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Girls"}),e.jsx("p",{className:"text-lg font-bold text-pink-600",children:s.girls})]})]})]},t)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"No entries yet"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Fill in student counts to see preview"})]})}),a.entries.filter(s=>s.boys+s.girls>0).length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t-2 flex-shrink-0",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium mb-2 uppercase",children:"Grand Total"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Boys"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:o.boys})]}),e.jsxs("div",{className:"text-center border-x border-gray-300",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Girls"}),e.jsx("p",{className:"text-xl font-bold text-pink-600",children:o.girls})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-indigo-600",children:o.total})]})]})]})})]})})]})]})})]})}export{L as default};
