import{u as I,r as g,j as e,H as q,L as j}from"./app-DIoTV-Eu.js";import{A as S}from"./AuthenticatedLayout-A_fvqcBE.js";import{F as D}from"./ArrowLeftIcon-CihGhzD6.js";import{F as B}from"./ShoppingBagIcon-Ec3y8qGN.js";import{F as G}from"./FireIcon-MxN25eGr.js";import{F as L}from"./PlusIcon-DsGfT8ts.js";import{F as T}from"./ExclamationCircleIcon-0DeBUsfu.js";import{F as $}from"./TrashIcon-aF-5SvXf.js";import"./transition-BmP7I9Uj.js";import"./AuthLogo-HkxrrMy2.js";import"./SupportChatWidget-C_aUtOX2.js";import"./createLucideIcon-Uben-nn_.js";function ae({auth:y,report:o,billType:c,billTypeLabel:x,prefillItems:p,schoolType:M,hasPrimary:U,hasMiddle:P,saltPercentages:u=null}){const{data:r,setData:i,post:b,processing:h,errors:l}=I({amount_report_id:o.id,bill_type:c,shop_name:"",address:"",shop_gstin:"",shopkeeper_name:"",phone:"",shop_license_no:"",payment_mode:"",fuel_type:c==="fuel"?"":null,deals_with:"",items:p.map(t=>({...t,rate_per_unit:"",quantity:0}))}),[N,f]=g.useState(0),v=Number(o.month??1),_=Number(o.year??new Date().getFullYear()),w=new Date(_,v,0).toLocaleDateString("en-IN",{day:"2-digit",month:"long",year:"numeric"});g.useEffect(()=>{const t=r.items.reduce((a,s)=>a+parseFloat(s.amount||0),0);f(t)},[r.items]);const C=(t,a)=>{const s=[...r.items],n=s[t];if(n.item_name!=="Other Condiments"){const m=parseFloat(n.amount)||0,d=parseFloat(a)||0;n.rate_per_unit=a,n.quantity=d>0?(m/d).toFixed(2):0}else n.rate_per_unit=a;s[t]=n,i("items",s)},A=(t,a)=>{const s=[...r.items],n=s[t],m=parseFloat(a)||0;if(n.amount=a,n.item_name!=="Other Condiments"){const d=parseFloat(n.rate_per_unit)||0;n.quantity=d>0?(m/d).toFixed(2):0}else{const d=parseFloat(n.quantity)||0;n.rate_per_unit=d>0?(m/d).toFixed(2):0}s[t]=n,i("items",s)},F=(t,a)=>{const s=[...r.items],n=s[t],m=parseFloat(a)||0,d=parseFloat(n.amount)||0;n.quantity=a,n.item_name==="Other Condiments"&&(n.rate_per_unit=m>0?(d/m).toFixed(2):0),s[t]=n,i("items",s)},k=(t,a)=>{const s=[...r.items];s[t].unit=a,i("items",s)},R=()=>{i("items",[...r.items,{item_name:"",amount:0,rate_per_unit:0,quantity:0,unit:"kg"}])},E=t=>{const a=r.items.filter((s,n)=>n!==t);i("items",a)},O=t=>{if(t.preventDefault(),r.items.filter(s=>parseFloat(s.rate_per_unit)<=0).length>0){alert("Please enter valid rates for all items (rate must be greater than 0)");return}b(route("bills.store"))};return e.jsxs(S,{user:y.user,children:[e.jsx(q,{title:`Create ${x} Bill`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(j,{href:route("amount-reports.bills.index",o.id),className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Back to Bills"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[c==="kiryana"?e.jsx(B,{className:"h-8 w-8 text-green-600"}):e.jsx(G,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Create ",x," Bill"]}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["For ",o.month_name," ",o.year]})]})]})]}),e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ðŸª VENDOR INFORMATION"}),e.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:["Bill Date auto-set to ",e.jsx("span",{className:"font-semibold",children:w})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Shop Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.shop_name,onChange:t=>i("shop_name",t.target.value.toUpperCase()),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase ${l.shop_name?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"E.G., ABC TRADERS"}),l.shop_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.shop_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Shop Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.address,onChange:t=>i("address",t.target.value.toUpperCase()),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase ${l.address?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"E.G., MARKET STREET, SRINAGAR"}),l.address&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.address})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop GSTIN"}),e.jsx("input",{type:"text",value:r.shop_gstin,onChange:t=>i("shop_gstin",t.target.value.toUpperCase()),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase",placeholder:"E.G., 22AAAAA0000A1Z5",maxLength:"15",pattern:"[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}"}),l.shop_gstin&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.shop_gstin})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contact Person ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.shopkeeper_name,onChange:t=>i("shopkeeper_name",t.target.value.toUpperCase()),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase ${l.shopkeeper_name?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"E.G., MR. VENDOR NAME"}),l.shopkeeper_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.shopkeeper_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:r.phone,onChange:t=>{const a=t.target.value.replace(/\D/g,"").slice(0,10);i("phone",a)},inputMode:"numeric",pattern:"[0-9]{10}",maxLength:10,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 ${l.phone?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"e.g., 9876543210"}),l.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop License No"}),e.jsx("input",{type:"text",value:r.shop_license_no,onChange:t=>i("shop_license_no",t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"e.g., LIC/SR/2024/001"}),l.shop_license_no&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.shop_license_no})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Mode ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"cash",checked:r.payment_mode==="cash",onChange:t=>i("payment_mode",t.target.value),className:"form-radio h-4 w-4 text-indigo-600",required:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Cash"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"upi",checked:r.payment_mode==="upi",onChange:t=>i("payment_mode",t.target.value),className:"form-radio h-4 w-4 text-indigo-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"UPI"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"credit",checked:r.payment_mode==="credit",onChange:t=>i("payment_mode",t.target.value),className:"form-radio h-4 w-4 text-indigo-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Credit"})]})]}),l.payment_mode&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.payment_mode})]}),c==="fuel"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Fuel Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"GAS",checked:r.fuel_type==="GAS",onChange:t=>i("fuel_type",t.target.value),className:"form-radio h-4 w-4 text-orange-600",required:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"GAS"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"FIREWOOD",checked:r.fuel_type==="FIREWOOD",onChange:t=>i("fuel_type",t.target.value),className:"form-radio h-4 w-4 text-orange-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"FIREWOOD"})]})]}),l.fuel_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.fuel_type})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deals With"}),e.jsx("textarea",{value:r.deals_with,onChange:t=>i("deals_with",t.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"E.g., Pulses, Vegetables, Oil, Condiments"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify the categories/items this vendor deals with. This appears on the bill."}),l.deals_with&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.deals_with})]})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bill Items"}),e.jsxs("button",{type:"button",onClick:R,className:`inline-flex items-center px-3 py-2 border border-indigo-600 rounded-md \r
                                        text-sm font-medium text-indigo-600 hover:bg-indigo-50`,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Add Item"]})]}),e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx(T,{className:"h-5 w-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsx("p",{className:"font-medium mb-1",children:"Auto-calculation enabled"}),e.jsxs("p",{children:["Enter the ",e.jsx("strong",{children:"Rate per Unit"})," and the ",e.jsx("strong",{children:"Quantity"})," will be calculated automatically using: Quantity = Amount Ã· Rate"]})]})]})}),c==="kiryana"&&u&&e.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("span",{className:"text-amber-600 font-semibold",children:"Salt Percentage Breakdown"})}),e.jsx("span",{className:"text-xs text-amber-700 uppercase tracking-wide",children:"Applies to all salt line items"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(u).map(([t,a])=>e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-amber-100",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t.replace("_"," ")}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Number(a).toFixed(2),"%"]})]},t))})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Item Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount (â‚¹)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate (â‚¹/unit)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.items.map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",value:t.item_name,onChange:s=>{const n=[...r.items];n[a].item_name=s.target.value,i("items",n)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0,disabled:p.some(s=>s.item_name===t.item_name&&!["Coriander","Other Condiments"].includes(s.item_name))})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",value:t.amount,onChange:s=>A(a,s.target.value),step:"0.01",min:"0",className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",value:t.rate_per_unit,onChange:s=>C(a,s.target.value),step:"0.01",min:"0.01",className:`w-24 px-2 py-1 border border-gray-300 rounded text-sm ${t.item_name==="Other Condiments"?"bg-gray-100":"bg-yellow-50"}`,required:!0,placeholder:t.item_name==="Other Condiments"?"Auto (Amt Ã· Qty)":"Enter rate",readOnly:t.item_name==="Other Condiments"})}),e.jsx("td",{className:"px-4 py-3",children:t.item_name==="Other Condiments"?e.jsx("input",{type:"number",value:t.quantity,onChange:s=>F(a,s.target.value),step:"0.01",min:"0",className:"w-24 px-2 py-1 border border-green-300 rounded text-sm bg-green-50",required:!0,placeholder:"Qty"}):e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-green-50 text-green-700 rounded text-sm font-medium",children:t.quantity||0})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("select",{value:t.unit,onChange:s=>k(a,s.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",children:[e.jsx("option",{value:"kg",children:"KG"}),e.jsx("option",{value:"litre",children:"LITRE"}),e.jsx("option",{value:"quintal",children:"QUINTAL"}),e.jsx("option",{value:"gram",children:"GRAM"}),e.jsx("option",{value:"piece",children:"PIECE"}),e.jsx("option",{value:"cylinder",children:"CYLINDER"}),e.jsx("option",{value:"box",children:"BOX"}),e.jsx("option",{value:"item",children:"ITEM"}),e.jsx("option",{value:"auto_fare",children:"AUTO FARE"})]})}),e.jsx("td",{className:"px-4 py-3",children:r.items.length>1&&e.jsx("button",{type:"button",onClick:()=>E(a),className:"text-red-600 hover:text-red-900",children:e.jsx($,{className:"h-5 w-5"})})})]},a))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"1",className:"px-4 py-3 text-right font-bold",children:"TOTAL:"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-lg font-bold text-indigo-600",children:["â‚¹ ",N.toFixed(2)]})}),e.jsx("td",{colSpan:"4"})]})})]})}),l.items&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:l.items})]}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(j,{href:route("amount-reports.bills.index",o.id),className:"text-sm text-gray-600 hover:text-gray-900",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h||r.items.length===0,className:`inline-flex items-center px-6 py-3 bg-indigo-600 border border-transparent \r
                                        rounded-md font-semibold text-sm text-white uppercase tracking-widest \r
                                        hover:bg-indigo-700 focus:bg-indigo-700 active:bg-indigo-900 \r
                                        focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 \r
                                        transition-all ease-in-out duration-150 disabled:opacity-50 disabled:cursor-not-allowed`,children:h?"Creating Bill...":"Create Bill"})]})})]})]})})]})}export{ae as default};
