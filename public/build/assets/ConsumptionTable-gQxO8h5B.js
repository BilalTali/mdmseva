import{r as n,j as e}from"./app-DIoTV-Eu.js";import{c as N}from"./createLucideIcon-Uben-nn_.js";import{C as S,a as L}from"./chevron-right-Tkt8Yx9P.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],R=N("chevrons-left",I);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],A=N("chevrons-right",E),q=({selectedMonth:o,selectedYear:c,schoolType:l="both"})=>{const[x,j]=n.useState([]),[w,p]=n.useState(!0),[u,g]=n.useState(null),[r,b]=n.useState(1),[i,k]=n.useState(1),[f,_]=n.useState(0),[m]=n.useState(10),v=l==="primary"||l==="middle",y=l==="middle";n.useEffect(()=>{D()},[o,c,r]);const D=async()=>{p(!0),g(null);try{const t=new URLSearchParams({page:r,per_page:m});o&&t.append("month",o),c&&t.append("year",c);const s=await fetch(`/ api / dashboard / consumptions ? ${t} `,{headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});if(!s.ok)throw new Error("Failed to fetch consumptions");const a=await s.json();j(a.data||[]),b(a.current_page||1),k(a.last_page||1),_(a.total||0)}catch(t){g(t.message),console.error("Error fetching consumptions:",t)}finally{p(!1)}},C=t=>{if(!t)return"N/A";try{const s=new Date(t);return isNaN(s.getTime())?"Invalid Date":s.toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}catch(s){return console.error("Date formatting error:",s),"Invalid Date"}},P=t=>{if(!t)return"N/A";try{const s=new Date(t);return isNaN(s.getTime())?"Invalid Date":s.toLocaleDateString("en-IN",{weekday:"short"})}catch{return"N/A"}},h=t=>new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t||0),d=t=>{t>=1&&t<=i&&b(t)};return w?e.jsx("div",{className:"bg-[var(--surface-00)] rounded-lg shadow-sm border border-[var(--border-light)] p-8 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 dark:border-blue-400"}),e.jsx("span",{className:"ml-3 text-[var(--text-secondary)]",children:"Loading consumptions..."})]})}):u?e.jsx("div",{className:"bg-[var(--surface-00)] rounded-lg shadow-sm border border-[var(--border-light)] p-6 transition-colors duration-200",children:e.jsxs("div",{className:"text-center text-red-600 ",children:[e.jsx("p",{className:"font-medium",children:"Error loading data"}),e.jsx("p",{className:"text-sm mt-1",children:u})]})}):e.jsxs("div",{className:"bg-[var(--surface-00)] rounded-lg shadow-sm border border-[var(--border-light)] transition-colors duration-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-[var(--border-light)]",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-[var(--text-primary)]",children:"Daily Consumption Records"}),e.jsxs("p",{className:"text-sm text-[var(--text-tertiary)] mt-1",children:["Showing ",x.length>0?(r-1)*m+1:0," to ",Math.min(r*m,f)," of ",f," records"]})]})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-[var(--border-light)]",children:[e.jsx("thead",{className:"bg-gray-50 ",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--text-tertiary)] uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-[var(--text-tertiary)] uppercase tracking-wider",children:"Day"}),v&&e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-[var(--text-tertiary)] uppercase tracking-wider",children:"Primary Students"}),y&&e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-[var(--text-tertiary)] uppercase tracking-wider",children:"Middle Students"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-[var(--text-tertiary)] uppercase tracking-wider",children:"Rice (kg)"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-[var(--text-tertiary)] uppercase tracking-wider",children:"Amount (₹)"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-[var(--text-tertiary)] uppercase tracking-wider",children:"Balance (kg)"})]})}),e.jsx("tbody",{className:"bg-[var(--surface-00)] divide-y divide-[var(--border-light)]",children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"text-[var(--text-muted)]",children:[e.jsx("p",{className:"text-lg font-medium",children:"No records found"}),e.jsx("p",{className:"text-sm mt-1",children:"Try adjusting your filters or add new consumption records"})]})})}):x.map(t=>e.jsxs("tr",{className:"hover:bg-[var(--surface-10)]/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-[var(--text-primary)]",children:C(t.date)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800  ",children:t.day||P(t.date)})}),v&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 ",children:t.served_primary||0}),y&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 ",children:t.served_middle||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("span",{className:"text-sm font-medium text-[var(--text-primary)]",children:h(t.rice_consumed)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("span",{className:"text-sm font-medium text-[var(--color-success)]",children:["₹",h(t.amount_consumed)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("span",{className:`text - sm font - medium ${t.rice_balance_after<50?"text-red-600 ":t.rice_balance_after<100?"text-yellow-600 dark:text-yellow-400":"text-[var(--text-primary)]"} `,children:h(t.rice_balance_after)})})]},t.id))})]})}),i>1&&e.jsx("div",{className:"px-6 py-4 border-t border-[var(--border-light)] bg-gray-50 dark:bg-gray-700/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-[var(--text-secondary)]",children:["Page ",e.jsx("span",{className:"font-medium",children:r})," of"," ",e.jsx("span",{className:"font-medium",children:i})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>d(1),disabled:r===1,className:"p-2 rounded-md border border-[var(--border-light)] bg-[var(--surface-00)] hover:bg-[var(--surface-10)] text-[var(--text-tertiary)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"First Page",children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>d(r-1),disabled:r===1,className:"p-2 rounded-md border border-[var(--border-light)] bg-[var(--surface-00)] hover:bg-[var(--surface-10)] text-[var(--text-tertiary)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Previous Page",children:e.jsx(S,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex items-center space-x-1",children:[...Array(i)].map((t,s)=>{const a=s+1;return a===1||a===i||a>=r-1&&a<=r+1?e.jsx("button",{onClick:()=>d(a),className:`px - 3 py - 1 rounded - md text - sm font - medium transition - colors ${a===r?"bg-blue-600 text-white":"bg-[var(--surface-00)] border border-[var(--border-light)] text-[var(--text-secondary)] hover:bg-[var(--surface-10)]"} `,children:a},a):a===r-2||a===r+2?e.jsx("span",{className:"px-2 text-[var(--text-muted)]",children:"..."},a):null})}),e.jsx("button",{onClick:()=>d(r+1),disabled:r===i,className:"p-2 rounded-md border border-[var(--border-light)] bg-[var(--surface-00)] hover:bg-[var(--surface-10)] text-[var(--text-tertiary)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Next Page",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>d(i),disabled:r===i,className:"p-2 rounded-md border border-[var(--border-light)] bg-[var(--surface-00)] hover:bg-[var(--surface-10)] text-[var(--text-tertiary)] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Last Page",children:e.jsx(A,{className:"w-4 h-4"})})]})]})})]})};export{q as default};
