import{j as e,r as $,H as P,L as I}from"./app-DHCAgeO8.js";import{A as B}from"./AuthenticatedLayout-dBQysIGU.js";import{C as F,a as M,b as T,c as R}from"./card-CU-RSoNk.js";import{c as s,s as r,t as d,b as z,a as A}from"./design-system-MVX2L2hn.js";import{c as L}from"./createLucideIcon-DQAdNBRm.js";import{T as E}from"./trash-2-r-OwMlc6.js";import"./ApplicationLogo-Da_2dMoK.js";import"./transition-jgp50ovQ.js";import"./send-BtT_p_gw.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]],S=L("indian-rupee",H);/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],O=L("pencil",V);function W({consumptions:t,schoolType:o,sections:l,openingBalance:p=0,onEdit:i,onDelete:c,showActions:_=!0}){if(console.log("ðŸ” RiceConsumptionTable Props:",{consumptionsCount:t?.length,openingBalance:p,sections:l,firstConsumption:t?.[0]}),!Array.isArray(t)||t.length===0)return e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No consumption records available."})});let y=p;console.log("ðŸ” Starting Balance:",y);const b=t.map((a,u)=>{const g=y,j=a.total_rice||0,m=Math.max(0,g-j);return(u===0||u===t.length-1)&&console.log(`ðŸ” ${u===0?"First":"Last"} Row Calculation:`,{date:a.date,opening_balance:g,consumed:j,closing_balance:m,primary_rice:a.primary_rice,middle_rice:a.middle_rice,served_primary:a.served_primary,served_middle:a.served_middle}),y=m,{...a,opening_balance:g,closing_balance:m}}),f=t.reduce((a,u)=>a+(u.total_rice||0),0),N=b[b.length-1]?.closing_balance||0,n=t.length>0?f/t.length:0;return console.log("ðŸ” Summary Calculations:",{openingBalance:p,totalConsumed:f,finalBalance:N,avgDaily:n,calculationCheck:`${p} - ${f} = ${N}`}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center",children:[e.jsx("svg",{className:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Rice Consumption Details"]}),e.jsxs("p",{className:"text-blue-100 text-sm mt-1",children:["Opening Balance (Rice Lifted + Opening Stock): ",e.jsxs("span",{className:"font-semibold",children:[p.toFixed(2)," kg"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Date/Day"}),l.includes("primary")&&e.jsxs("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:[e.jsx("div",{children:"Primary"}),e.jsx("div",{className:"text-gray-500 font-normal",children:"(Students)"})]}),l.includes("middle")&&e.jsxs("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:[e.jsx("div",{children:"Middle"}),e.jsx("div",{className:"text-gray-500 font-normal",children:"(Students)"})]}),l.includes("primary")&&e.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:[e.jsx("div",{children:"Primary"}),e.jsx("div",{className:"text-gray-500 font-normal",children:"(Rice KG)"})]}),l.includes("middle")&&e.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:[e.jsx("div",{children:"Middle"}),e.jsx("div",{className:"text-gray-500 font-normal",children:"(Rice KG)"})]}),e.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-blue-700 uppercase tracking-wider bg-blue-50",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{className:"text-blue-600 font-normal",children:"(Consumed KG)"})]}),e.jsxs("th",{className:"px-6 py-3 text-right text-xs font-semibold text-green-700 uppercase tracking-wider bg-green-50",children:[e.jsx("div",{children:"Balance After"}),e.jsx("div",{className:"text-green-600 font-normal",children:"(Stock KG)"})]}),_&&e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map((a,u)=>{const g=a.primary_rice||0,j=a.middle_rice||0,m=a.total_rice||0;return e.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${u%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:new Date(a.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),e.jsx("div",{className:"text-xs text-gray-500",children:a.day})]}),l.includes("primary")&&e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-purple-100 text-purple-800",children:a.served_primary||0})}),l.includes("middle")&&e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-indigo-100 text-indigo-800",children:a.served_middle||0})}),l.includes("primary")&&e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:g.toFixed(2)})}),l.includes("middle")&&e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:j.toFixed(2)})}),e.jsx("td",{className:"px-6 py-4 text-right bg-blue-50",children:e.jsxs("span",{className:"text-sm font-bold text-blue-700",children:[m.toFixed(2)," kg"]})}),e.jsx("td",{className:"px-6 py-4 text-right bg-green-50",children:e.jsxs("span",{className:`text-sm font-bold ${a.closing_balance<10?"text-red-600":a.closing_balance<50?"text-orange-600":"text-green-700"}`,children:[a.closing_balance.toFixed(2)," kg"]})}),_&&e.jsx("td",{className:"px-6 py-4 text-center whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:()=>i(a),className:"inline-flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 text-sm font-medium rounded-lg hover:bg-blue-200 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),e.jsxs("button",{onClick:()=>c(a),className:"inline-flex items-center px-3 py-1.5 bg-red-100 text-red-700 text-sm font-medium rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})})]},a.id)})})]})}),e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Total Records"}),e.jsx("div",{className:"text-lg font-bold text-gray-900",children:t.length})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Total Consumed"}),e.jsxs("div",{className:"text-lg font-bold text-blue-700",children:[f.toFixed(2)," kg"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Final Balance"}),e.jsxs("div",{className:"text-lg font-bold text-green-700",children:[N.toFixed(2)," kg"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Avg Daily"}),e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[n.toFixed(2)," kg"]})]})]})})]})}const C={PRIMARY:"primary",MIDDLE:"middle",SECONDARY:"secondary"},Y=t=>{const o={primary:{type:C.PRIMARY,label:"Primary School (Classes I-V)",sections:["primary"],hasPrimary:!0,hasMiddle:!1,riceColumns:["date","day","served_primary","primary_rice","total_rice","remaining_balance","actions"],amountColumns:["date","served_primary","primary_pulses","primary_vegetables","primary_oil","primary_salt","primary_fuel","amount_primary","total_amount_consumed","cumulative_amount"]},middle:{type:C.MIDDLE,label:"Primary + Middle School (Classes I-VIII)",sections:["primary","middle"],hasPrimary:!0,hasMiddle:!0,riceColumns:["date","day","served_primary","primary_rice","served_middle","middle_rice","total_rice","remaining_balance","actions"],amountColumns:["date","served_primary","primary_pulses","primary_vegetables","primary_oil","primary_salt","primary_fuel","amount_primary","served_middle","middle_pulses","middle_vegetables","middle_oil","middle_salt","middle_fuel","amount_middle","total_amount_consumed","cumulative_amount"]},secondary:{type:C.SECONDARY,label:"Middle School (Classes VI-VIII)",sections:["middle"],hasPrimary:!1,hasMiddle:!0,riceColumns:["date","day","served_middle","middle_rice","total_rice","remaining_balance","actions"],amountColumns:["date","served_middle","middle_pulses","middle_vegetables","middle_oil","middle_salt","middle_fuel","amount_middle","total_amount_consumed","cumulative_amount"]}};return o[t]||o.primary},G=t=>{const o=parseFloat(t)||0;return o<0||o<10?"text-red-600":o<50?"text-orange-600":"text-green-600"};function K({columns:t=[],tableType:o="rice",sections:l=[]}){const p=l.includes("primary"),i=l.includes("middle"),c=p&&i,_=()=>{const b=c?2:1,f=c?2:1;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-300",children:[e.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-r",children:"Date/day"}),e.jsx("th",{colSpan:b,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-blue-50",children:"Students"}),e.jsx("th",{colSpan:f,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-purple-50",children:"Rice consumed"}),e.jsxs("th",{rowSpan:"2",className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-green-50",children:["Total",e.jsx("br",{}),"Consumed (kg)"]}),e.jsxs("th",{rowSpan:"2",className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-yellow-50",children:["Remaining",e.jsx("br",{}),"Balance (kg)"]}),e.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Actions"})]}),e.jsxs("tr",{className:"bg-gray-50 border-b",children:[i&&e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"Middle"}),p&&e.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase border-r",children:"Primary"}),i&&e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"Middle (kg)"}),p&&e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-600 uppercase border-r",children:"Primary (kg)"})]})]})},y=()=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"bg-gray-100 border-b-2 border-gray-300",children:[e.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider border-r",children:"Date"}),e.jsx("th",{colSpan:c?2:1,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-blue-50",children:"Students"}),e.jsx("th",{colSpan:c?2:1,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-purple-50",children:"Pulses"}),e.jsx("th",{colSpan:c?2:1,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-indigo-50",children:"Vegetables"}),e.jsx("th",{colSpan:c?2:1,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-pink-50",children:"Oil"}),e.jsx("th",{colSpan:c?2:1,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-orange-50",children:"Ingredients"}),e.jsx("th",{colSpan:c?2:1,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-red-50",children:"Fuel"}),e.jsx("th",{colSpan:c?2:1,className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-cyan-50",children:"Amount Consumed"}),e.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider border-r bg-green-50",children:"Total"}),e.jsx("th",{rowSpan:"2",className:"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider bg-yellow-50",children:"Cumulative"})]}),e.jsxs("tr",{className:"bg-gray-50 border-b",children:[p&&e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase",children:"P"}),i&&e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-600 uppercase border-r",children:"M"}),p&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"P"}),i&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase border-r",children:"M"}),p&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"P"}),i&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase border-r",children:"M"}),p&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"P"}),i&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase border-r",children:"M"}),p&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"P"}),i&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase border-r",children:"M"}),p&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"P"}),i&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase border-r",children:"M"}),p&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase",children:"P"}),i&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-600 uppercase border-r",children:"M"})]})]});return e.jsx("thead",{children:o==="amount"?y():_()})}const v=t=>`${(parseFloat(t)||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})} kg`,x=t=>`â‚¹${(parseFloat(t)||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,D=t=>{if(!t)return"";const o=new Date(t),l=String(o.getDate()).padStart(2,"0"),p=String(o.getMonth()+1).padStart(2,"0"),i=o.getFullYear();return`${l}/${p}/${i}`},q=t=>t?new Date(t).toLocaleDateString("en-US",{weekday:"long"}):"";function U({entry:t,columns:o=[],tableType:l="rice",sections:p=[],onEdit:i,onDelete:c,showActions:_=!0}){const y=p.includes("primary"),b=p.includes("middle"),f=()=>{const a=parseFloat(t.remaining_balance||t.rice_balance_after||0),u=G(a);return e.jsxs(e.Fragment,{children:[e.jsxs("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] font-medium border-r`,style:{color:s.text.primary},children:[e.jsx("div",{children:D(t.date)}),e.jsx("div",{className:`text-[${d.fontSize.xs}]`,style:{color:s.text.quaternary},children:q(t.date)})]}),b&&e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-center font-medium`,style:{color:s.text.primary},children:parseInt(t.served_middle)||0}),y&&e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-center font-medium border-r`,style:{color:s.text.primary},children:parseInt(t.served_primary)||0}),b&&e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-right`,style:{color:s.text.secondary},children:v(t.middle_rice||0)}),y&&e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-right border-r`,style:{color:s.text.secondary},children:v(t.primary_rice||0)}),e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-right font-semibold border-r`,style:{backgroundColor:s.success[50],color:s.text.primary},children:v(t.total_rice||t.rice_consumed||0)}),e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-right font-bold border-r ${u}`,children:v(a)}),_&&n()]})},N=()=>{const a=parseFloat(t.primary_total||0),u=parseFloat(t.middle_total||0),g=a+u,j=parseFloat(t.cumulative_amount||t.cumulative_total||t.cumulativeAmount||0);return e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] font-medium border-r`,style:{color:s.text.primary},children:D(t.date)}),y&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-center font-medium`,style:{color:s.text.primary},children:parseInt(t.served_primary)||0}),b&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-center font-medium border-r`,style:{color:s.text.primary},children:parseInt(t.served_middle)||0}),y&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right`,style:{color:s.text.secondary},children:x(t.primary_pulses||0)}),b&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right border-r`,style:{color:s.text.secondary},children:x(t.middle_pulses||0)}),y&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right`,style:{color:s.text.secondary},children:x(t.primary_vegetables||0)}),b&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right border-r`,style:{color:s.text.secondary},children:x(t.middle_vegetables||0)}),y&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right`,style:{color:s.text.secondary},children:x(t.primary_oil||0)}),b&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right border-r`,style:{color:s.text.secondary},children:x(t.middle_oil||0)}),y&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right`,style:{color:s.text.secondary},children:x(t.primary_salt||0)}),b&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right border-r`,style:{color:s.text.secondary},children:x(t.middle_salt||0)}),y&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right`,style:{color:s.text.secondary},children:x(t.primary_fuel||0)}),b&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right border-r`,style:{color:s.text.secondary},children:x(t.middle_fuel||0)}),y&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right font-semibold`,style:{backgroundColor:s.info[50],color:s.info[700]},children:x(a)}),b&&e.jsx("td",{className:`px-${r[3]} py-${r[3]} text-[${d.fontSize.sm}] text-right font-semibold border-r`,style:{backgroundColor:s.secondary[50],color:s.secondary[700]},children:x(u)}),e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-right font-bold border-r`,style:{backgroundColor:s.success[50],color:s.success[700]},children:x(g)}),e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-right font-bold border-r`,style:{backgroundColor:s.warning[50],color:s.warning[700]},children:x(j)}),_&&n()]})},n=()=>e.jsx("td",{className:`px-${r[4]} py-${r[3]} text-[${d.fontSize.sm}] text-center whitespace-nowrap`,children:e.jsxs("div",{className:`flex items-center justify-center gap-${r[2]}`,children:[i&&e.jsxs("button",{onClick:()=>i(t),className:`inline-flex items-center px-${r[3]} py-${r[2]} border text-[${d.fontSize.xs}] font-medium rounded transition-colors`,style:{backgroundColor:s.background.primary,borderColor:s.border.medium,color:s.text.secondary,boxShadow:A.sm,borderRadius:z.md},onMouseEnter:a=>{a.currentTarget.style.backgroundColor=s.secondary[100]},onMouseLeave:a=>{a.currentTarget.style.backgroundColor=s.background.primary},title:"Edit entry",children:[e.jsx(O,{className:`w-3.5 h-3.5 mr-${r[1]}`}),"Edit"]}),c&&e.jsxs("button",{onClick:()=>c(t),className:`inline-flex items-center px-${r[3]} py-${r[2]} border text-[${d.fontSize.xs}] font-medium rounded transition-colors`,style:{backgroundColor:s.background.primary,borderColor:s.error[300],color:s.error[700],boxShadow:A.sm,borderRadius:z.md},onMouseEnter:a=>{a.currentTarget.style.backgroundColor=s.error[50]},onMouseLeave:a=>{a.currentTarget.style.backgroundColor=s.background.primary},title:"Delete entry",children:[e.jsx(E,{className:`w-3.5 h-3.5 mr-${r[1]}`}),"Delete"]})]})});return e.jsx("tr",{className:"border-b transition-colors",style:{borderColor:s.border.light},onMouseEnter:a=>{a.currentTarget.style.backgroundColor=s.background.secondary},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent"},children:l==="amount"?N():f()})}function J({columns:t=[],tableType:o="rice",totals:l={},sections:p=[]}){const i=p.includes("primary"),c=p.includes("middle"),_=()=>{const b=l.served_primary||0,f=l.served_middle||0,N=l.amount_primary||0,n=l.amount_middle||0,a=l.total_amount_consumed||0;return e.jsxs("tr",{className:"bg-gray-100 border-t-2 border-gray-300",children:[e.jsx("td",{className:"px-4 py-4 text-sm font-bold text-gray-900 uppercase border-r",children:"Total Summary"}),c&&e.jsx("td",{className:"px-4 py-4 text-sm text-center font-bold text-gray-900",children:f.toLocaleString()}),i&&e.jsx("td",{className:"px-4 py-4 text-sm text-center font-bold text-gray-900 border-r",children:b.toLocaleString()}),c&&e.jsx("td",{className:"px-4 py-4 text-sm text-right font-bold text-gray-900",children:v(n)}),i&&e.jsx("td",{className:"px-4 py-4 text-sm text-right font-bold text-gray-900 border-r",children:v(N)}),e.jsx("td",{className:"px-4 py-4 text-sm text-right font-bold text-green-900 bg-green-100 border-r",children:v(a)}),e.jsx("td",{className:"px-4 py-4 text-sm text-right font-bold text-yellow-900 bg-yellow-100 border-r",children:"-"}),e.jsx("td",{className:"px-4 py-4"})]})},y=()=>e.jsxs("tr",{className:"bg-gray-100 border-t-2 border-gray-300",children:[e.jsx("td",{className:"px-4 py-4 text-sm font-bold text-gray-900 uppercase border-r",children:"Total Summary"}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-center font-bold text-gray-900",children:(l.primary_students||0).toLocaleString()}),c&&e.jsx("td",{className:"px-3 py-4 text-sm text-center font-bold text-gray-900 border-r",children:(l.middle_students||0).toLocaleString()}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900",children:x(l.primary_pulses||0)}),c&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900 border-r",children:x(l.middle_pulses||0)}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900",children:x(l.primary_vegetables||0)}),c&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900 border-r",children:x(l.middle_vegetables||0)}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900",children:x(l.primary_oil||0)}),c&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900 border-r",children:x(l.middle_oil||0)}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900",children:x(l.primary_salt||0)}),c&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900 border-r",children:x(l.middle_salt||0)}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900",children:x(l.primary_fuel||0)}),c&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-gray-900 border-r",children:x(l.middle_fuel||0)}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-blue-900 bg-blue-100",children:x(l.primary_subtotal||0)}),c&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-purple-900 bg-purple-100 border-r",children:x(l.middle_subtotal||0)}),i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-green-900 bg-green-100",children:x(l.total_amount||0)}),c&&!i&&e.jsx("td",{className:"px-3 py-4 text-sm text-right font-bold text-green-900 bg-green-100 border-r",children:x(l.middle_subtotal||0)}),e.jsx("td",{className:"px-4 py-4 text-sm text-right font-bold text-yellow-900 bg-yellow-100",children:x(l.total_amount||0)})]});return e.jsx("tfoot",{children:o==="amount"?y():_()})}function Q({entries:t=[],consumptions:o=[],schoolType:l,schoolConfig:p,sections:i=[],className:c=""}){const _=p||Y(l),{hasPrimary:y,hasMiddle:b,amountColumns:f,sections:N}=_,n=t.length>0?t:o,a=i.length>0?i:N,u=$.useMemo(()=>{if(n.length>0&&n[0].cumulative_amount!==void 0)return console.log("âœ… Using backend cumulative data:",n[0].cumulative_amount),n;console.log("âš ï¸ Backend missing cumulative_amount, calculating on frontend");let j=0;return n.map(m=>{const h=parseFloat(m.primary_total||m.primary_subtotal)||0,w=parseFloat(m.middle_total||m.middle_subtotal)||0,k=h+w;return j+=k,{...m,cumulative_amount:j}})},[n]),g=$.useMemo(()=>{const j={primary_students:0,primary_pulses:0,primary_vegetables:0,primary_oil:0,primary_salt:0,primary_fuel:0,primary_subtotal:0,middle_students:0,middle_pulses:0,middle_vegetables:0,middle_oil:0,middle_salt:0,middle_fuel:0,middle_subtotal:0,total_amount:0};return u.reduce((m,h)=>{y&&(m.primary_students+=parseInt(h.served_primary||h.primary_students)||0,m.primary_pulses+=parseFloat(h.primary_pulses)||0,m.primary_vegetables+=parseFloat(h.primary_vegetables)||0,m.primary_oil+=parseFloat(h.primary_oil)||0,m.primary_salt+=parseFloat(h.primary_salt)||0,m.primary_fuel+=parseFloat(h.primary_fuel)||0,m.primary_subtotal+=parseFloat(h.primary_subtotal||h.primary_total)||0),b&&(m.middle_students+=parseInt(h.served_middle||h.middle_students)||0,m.middle_pulses+=parseFloat(h.middle_pulses)||0,m.middle_vegetables+=parseFloat(h.middle_vegetables)||0,m.middle_oil+=parseFloat(h.middle_oil)||0,m.middle_salt+=parseFloat(h.middle_salt)||0,m.middle_fuel+=parseFloat(h.middle_fuel)||0,m.middle_subtotal+=parseFloat(h.middle_subtotal||h.middle_total)||0);const w=parseFloat(h.primary_total||h.primary_subtotal)||0,k=parseFloat(h.middle_total||h.middle_subtotal)||0;return m.total_amount+=w+k,m},j)},[u,y,b]);return $.useMemo(()=>u.length===0?0:u[u.length-1]?.cumulative_amount||0,[u]),$.useMemo(()=>({pulses:(g.primary_pulses||0)+(g.middle_pulses||0),vegetables:(g.primary_vegetables||0)+(g.middle_vegetables||0),oil:(g.primary_oil||0)+(g.middle_oil||0),salt:(g.primary_salt||0)+(g.middle_salt||0),fuel:(g.primary_fuel||0)+(g.middle_fuel||0)}),[g]),n.length===0?e.jsxs(F,{className:c,children:[e.jsx(M,{children:e.jsxs(T,{className:`text-[${d.fontSize.lg}] font-semibold flex items-center`,style:{color:s.success[600]},children:[e.jsx(S,{className:`w-5 h-5 mr-${r[2]}`}),"Amount Consumption Records"]})}),e.jsx(R,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full mb-${r[4]}`,style:{backgroundColor:s.background.tertiary},children:e.jsx(S,{className:"w-8 h-8",style:{color:s.text.quaternary}})}),e.jsx("h3",{className:`text-[${d.fontSize.lg}] font-medium mb-${r[2]}`,style:{color:s.text.primary},children:"No Records Yet"}),e.jsx("p",{className:`text-[${d.fontSize.sm}]`,style:{color:s.text.tertiary},children:"Amount consumption records will appear here once you add daily entries."})]})})]}):e.jsxs(F,{className:c,children:[e.jsx(M,{children:e.jsxs(T,{className:`text-[${d.fontSize.lg}] font-semibold flex items-center justify-between`,style:{color:s.text.primary},children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(S,{className:`w-5 h-5 mr-${r[2]}`,style:{color:s.success[600]}}),"Amount Consumption Details"]}),e.jsxs("span",{className:`text-[${d.fontSize.sm}] font-normal`,style:{color:s.text.tertiary},children:[n.length," ",n.length===1?"entry":"entries"]})]})}),e.jsx(R,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto max-h-[500px] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y",style:{borderColor:s.border.light},children:[e.jsx(K,{columns:f,tableType:"amount",sections:a}),e.jsx("tbody",{className:"divide-y",style:{backgroundColor:s.background.primary,borderColor:s.border.light},children:u.map(j=>e.jsx(U,{entry:j,columns:f,tableType:"amount",sections:a,showActions:!1},j.id))}),e.jsx(J,{columns:f,tableType:"amount",totals:g,sections:a})]})})})]})}function de(t){const{school:o={},riceConfiguration:l=null,dailyConsumptions:p=[],consumptionsWithCalculations:i=[],consumptionSummary:c={},riceReports:_=[],amountReports:y=[],bills:b=[],rollStatement:f=null,schoolStats:N={},filters:n={},schoolType:a=null,sections:u=[],openingBalance:g=0}=t;return e.jsxs(B,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{href:route("admin.schools.index"),className:"mr-4 text-gray-600 hover:text-gray-900",children:"Back"}),e.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:["School Details",o?.school_name?` - ${o.school_name}`:""]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:o?.district?.name?`District: ${o.district.name}`:""})]}),children:[e.jsx(P,{title:`Admin - School ${o?.school_name||o?.name||""}`}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Rice Consumption (Read-only)"}),(n?.date_from||n?.date_to)&&e.jsxs("div",{className:"text-sm text-gray-600",children:[n?.date_from?`From: ${n.date_from}`:"",n?.date_to?` To: ${n.date_to}`:""]})]}),e.jsx(W,{consumptions:Array.isArray(i)?i:[],schoolType:a||o?.school_type,sections:Array.isArray(u)&&u.length?u:o?.sections||["primary","middle"],openingBalance:typeof g=="number"?g:0,showActions:!1})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Amount Consumption (Read-only)"}),(n?.date_from||n?.date_to)&&e.jsxs("div",{className:"text-sm text-gray-600",children:[n?.date_from?`From: ${n.date_from}`:"",n?.date_to?` To: ${n.date_to}`:""]})]}),e.jsx(Q,{entries:Array.isArray(i)?i:[],schoolType:a||o?.school_type,sections:Array.isArray(u)?u:[],className:""})]})]})})]})}export{de as default};
