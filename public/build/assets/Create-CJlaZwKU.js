import{u as E,r as h,j as e,H as S,L as g}from"./app-DHCAgeO8.js";import{A as D}from"./AuthenticatedLayout-dBQysIGU.js";import{F as q}from"./ArrowLeftIcon-DrcUL1d9.js";import{F as I}from"./ShoppingBagIcon-CHRBFTnl.js";import{F as O}from"./FireIcon-BhEj2yLi.js";import{F as B}from"./PlusIcon-FUyhv6pH.js";import{F as $}from"./ExclamationCircleIcon-HVPBVTv1.js";import{F as G}from"./TrashIcon-CZFt2Xjj.js";import"./ApplicationLogo-Da_2dMoK.js";import"./transition-jgp50ovQ.js";import"./createLucideIcon-DQAdNBRm.js";import"./send-BtT_p_gw.js";function te({auth:j,report:d,billType:m,billTypeLabel:c,prefillItems:x,schoolType:L,hasPrimary:M,hasMiddle:U,saltPercentages:p=null}){const{data:a,setData:n,post:b,processing:u,errors:r}=E({amount_report_id:d.id,bill_type:m,shop_name:"",address:"",shop_gstin:"",shopkeeper_name:"",phone:"",shop_license_no:"",payment_mode:"",fuel_type:m==="fuel"?"":null,deals_with:"",items:x.map(t=>({...t,rate_per_unit:"",quantity:0}))}),[y,N]=h.useState(0),f=Number(d.month??1),v=Number(d.year??new Date().getFullYear()),_=new Date(v,f,0).toLocaleDateString("en-IN",{day:"2-digit",month:"long",year:"numeric"});h.useEffect(()=>{const t=a.items.reduce((l,s)=>l+parseFloat(s.amount||0),0);N(t)},[a.items]);const w=(t,l)=>{const s=[...a.items],i=parseFloat(s[t].amount)||0,o=parseFloat(l)||0;s[t].rate_per_unit=l,s[t].quantity=o>0?(i/o).toFixed(2):0,n("items",s)},C=(t,l)=>{const s=[...a.items],i=parseFloat(l)||0,o=parseFloat(s[t].rate_per_unit)||0;s[t].amount=l,s[t].quantity=o>0?(i/o).toFixed(2):0,n("items",s)},A=(t,l)=>{const s=[...a.items];s[t].unit=l,n("items",s)},k=()=>{n("items",[...a.items,{item_name:"",amount:0,rate_per_unit:0,quantity:0,unit:"kg"}])},F=t=>{const l=a.items.filter((s,i)=>i!==t);n("items",l)},R=t=>{if(t.preventDefault(),a.items.filter(s=>parseFloat(s.rate_per_unit)<=0).length>0){alert("Please enter valid rates for all items (rate must be greater than 0)");return}b(route("bills.store"))};return e.jsxs(D,{user:j.user,children:[e.jsx(S,{title:`Create ${c} Bill`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(g,{href:route("amount-reports.bills.index",d.id),className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Back to Bills"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[m==="kiryana"?e.jsx(I,{className:"h-8 w-8 text-green-600"}):e.jsx(O,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Create ",c," Bill"]}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["For ",d.month_name," ",d.year]})]})]})]}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ðŸª VENDOR INFORMATION"}),e.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:["Bill Date auto-set to ",e.jsx("span",{className:"font-semibold",children:_})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Shop Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.shop_name,onChange:t=>n("shop_name",t.target.value.toUpperCase()),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase ${r.shop_name?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"E.G., ABC TRADERS"}),r.shop_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.shop_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Shop Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.address,onChange:t=>n("address",t.target.value.toUpperCase()),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase ${r.address?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"E.G., MARKET STREET, SRINAGAR"}),r.address&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.address})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop GSTIN"}),e.jsx("input",{type:"text",value:a.shop_gstin,onChange:t=>n("shop_gstin",t.target.value.toUpperCase()),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase",placeholder:"E.G., 22AAAAA0000A1Z5",maxLength:"15",pattern:"[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}"}),r.shop_gstin&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.shop_gstin})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contact Person ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.shopkeeper_name,onChange:t=>n("shopkeeper_name",t.target.value.toUpperCase()),className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 uppercase ${r.shopkeeper_name?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"E.G., MR. VENDOR NAME"}),r.shopkeeper_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.shopkeeper_name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contact Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:a.phone,onChange:t=>{const l=t.target.value.replace(/\D/g,"").slice(0,10);n("phone",l)},inputMode:"numeric",pattern:"[0-9]{10}",maxLength:10,className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 ${r.phone?"border-red-500":"border-gray-300"}`,required:!0,placeholder:"e.g., 9876543210"}),r.phone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shop License No"}),e.jsx("input",{type:"text",value:a.shop_license_no,onChange:t=>n("shop_license_no",t.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"e.g., LIC/SR/2024/001"}),r.shop_license_no&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.shop_license_no})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Mode ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"cash",checked:a.payment_mode==="cash",onChange:t=>n("payment_mode",t.target.value),className:"form-radio h-4 w-4 text-indigo-600",required:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Cash"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"upi",checked:a.payment_mode==="upi",onChange:t=>n("payment_mode",t.target.value),className:"form-radio h-4 w-4 text-indigo-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"UPI"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"credit",checked:a.payment_mode==="credit",onChange:t=>n("payment_mode",t.target.value),className:"form-radio h-4 w-4 text-indigo-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Credit"})]})]}),r.payment_mode&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.payment_mode})]}),m==="fuel"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Fuel Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"GAS",checked:a.fuel_type==="GAS",onChange:t=>n("fuel_type",t.target.value),className:"form-radio h-4 w-4 text-orange-600",required:!0}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"GAS"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",value:"FIREWOOD",checked:a.fuel_type==="FIREWOOD",onChange:t=>n("fuel_type",t.target.value),className:"form-radio h-4 w-4 text-orange-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"FIREWOOD"})]})]}),r.fuel_type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.fuel_type})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deals With"}),e.jsx("textarea",{value:a.deals_with,onChange:t=>n("deals_with",t.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500",placeholder:"E.g., Pulses, Vegetables, Oil, Condiments"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Specify the categories/items this vendor deals with. This appears on the bill."}),r.deals_with&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.deals_with})]})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bill Items"}),e.jsxs("button",{type:"button",onClick:k,className:`inline-flex items-center px-3 py-2 border border-indigo-600 rounded-md \r
                                        text-sm font-medium text-indigo-600 hover:bg-indigo-50`,children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add Item"]})]}),e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx($,{className:"h-5 w-5 text-blue-500 mr-3 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsx("p",{className:"font-medium mb-1",children:"Auto-calculation enabled"}),e.jsxs("p",{children:["Enter the ",e.jsx("strong",{children:"Rate per Unit"})," and the ",e.jsx("strong",{children:"Quantity"})," will be calculated automatically using: Quantity = Amount Ã· Rate"]})]})]})}),m==="kiryana"&&p&&e.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("span",{className:"text-amber-600 font-semibold",children:"Salt Percentage Breakdown"})}),e.jsx("span",{className:"text-xs text-amber-700 uppercase tracking-wide",children:"Applies to all salt line items"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(p).map(([t,l])=>e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border border-amber-100",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:t.replace("_"," ")}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Number(l).toFixed(2),"%"]})]},t))})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Item Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount (â‚¹)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate (â‚¹/unit)"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Unit"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.items.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"text",value:t.item_name,onChange:s=>{const i=[...a.items];i[l].item_name=s.target.value,n("items",i)},className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0,disabled:x.some(s=>s.item_name===t.item_name)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",value:t.amount,onChange:s=>C(l,s.target.value),step:"0.01",min:"0",className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",value:t.rate_per_unit,onChange:s=>w(l,s.target.value),step:"0.01",min:"0.01",className:"w-24 px-2 py-1 border border-gray-300 rounded text-sm bg-yellow-50",required:!0,placeholder:"Enter rate"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-green-50 text-green-700 rounded text-sm font-medium",children:t.quantity})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("select",{value:t.unit,onChange:s=>A(l,s.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm",children:[e.jsx("option",{value:"kg",children:"kg"}),e.jsx("option",{value:"litre",children:"litre"}),e.jsx("option",{value:"quintal",children:"quintal"}),e.jsx("option",{value:"gram",children:"gram"}),e.jsx("option",{value:"piece",children:"piece"})]})}),e.jsx("td",{className:"px-4 py-3",children:a.items.length>1&&e.jsx("button",{type:"button",onClick:()=>F(l),className:"text-red-600 hover:text-red-900",children:e.jsx(G,{className:"h-5 w-5"})})})]},l))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"1",className:"px-4 py-3 text-right font-bold",children:"TOTAL:"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"text-lg font-bold text-indigo-600",children:["â‚¹ ",y.toFixed(2)]})}),e.jsx("td",{colSpan:"4"})]})})]})}),r.items&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r.items})]}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{href:route("amount-reports.bills.index",d.id),className:"text-sm text-gray-600 hover:text-gray-900",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u||a.items.length===0,className:`inline-flex items-center px-6 py-3 bg-indigo-600 border border-transparent \r
                                        rounded-md font-semibold text-sm text-white uppercase tracking-widest \r
                                        hover:bg-indigo-700 focus:bg-indigo-700 active:bg-indigo-900 \r
                                        focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 \r
                                        transition-all ease-in-out duration-150 disabled:opacity-50 disabled:cursor-not-allowed`,children:u?"Creating Bill...":"Create Bill"})]})})]})]})})]})}export{te as default};
