import{j as e,r as u,H as L,L as m,a as c}from"./app-B7rG-o2v.js";import{A as _}from"./AuthenticatedLayout-DsY28lw4.js";import{F as T}from"./FilterPanel-C_cN87Qa.js";import{h as j}from"./dialog-C3OSo4dj.js";import{K as w}from"./transition-rTlxp94F.js";import"./AuthLogo-BstlY2F2.js";import"./SupportChatWidget-BH2cX72p.js";import"./createLucideIcon-htJommDS.js";import"./with-selector-BN3VHCxf.js";import"./index-Ch5_Xa7z.js";function D({status:n,size:s="md"}){const a=n==="active"||n===!0||n===1,g={sm:"px-2 py-0.5 text-xs",md:"px-2.5 py-1 text-sm",lg:"px-3 py-1.5 text-base"},r="inline-flex items-center font-medium rounded-full",o=a?"bg-green-100 text-green-800":"bg-red-100 text-red-800";return e.jsxs("span",{className:`${r} ${g[s]} ${o}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 mr-1.5 rounded-full ${a?"bg-green-600":"bg-red-600"}`}),a?"Active":"Inactive"]})}function N({isOpen:n,onClose:s,onConfirm:a,title:g,message:r,variant:o="info",confirmText:h="Confirm",cancelText:i="Cancel",processing:p=!1}){const f={info:{icon:"text-blue-600",button:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"},warning:{icon:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500"},danger:{icon:"text-red-600",button:"bg-red-600 hover:bg-red-700 focus:ring-red-500"}},d=f[o]||f.info;return e.jsx(w,{appear:!0,show:n,as:u.Fragment,children:e.jsxs(j,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(w.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(w.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(j.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:o==="warning"||o==="danger"?e.jsx("svg",{className:`h-6 w-6 ${d.icon}`,fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}):e.jsx("svg",{className:`h-6 w-6 ${d.icon}`,fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx(j.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:g}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:r})})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end space-x-3",children:[e.jsx("button",{type:"button",className:"inline-flex justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",onClick:s,disabled:p,children:i}),e.jsx("button",{type:"button",className:`inline-flex justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 ${d.button}`,onClick:a,disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):h})]})]})})})})]})})}const b=n=>{if(typeof n!="string")return"";const s=document.createElement("textarea");return s.innerHTML=n,s.value.replace(/<[^>]*>/g,"")};function V({auth:n,schools:s,filters:a={},stats:g={}}){const[r,o]=u.useState({isOpen:!1,school:null,action:null}),[h,i]=u.useState(!1),p=t=>{c.get(route("admin.schools.index"),t,{preserveState:!0,preserveScroll:!0})},f=()=>{c.get(route("admin.schools.index"),{},{preserveState:!0,preserveScroll:!0})},d=t=>{const l=a.sort===t&&a.direction==="asc"?"desc":"asc";c.get(route("admin.schools.index"),{...a,sort:t,direction:l},{preserveState:!0,preserveScroll:!0})},y=(t,l)=>{o({isOpen:!0,school:t,action:l})},x=()=>{o({isOpen:!1,school:null,action:null})},k=()=>{i(!0),c.post(route("admin.schools.activate",r.school.id),{},{preserveScroll:!0,onSuccess:()=>{c.reload({only:["schools"]}),x(),i(!1)},onError:t=>{i(!1),console.error("Activation failed:",t)}})},C=()=>{i(!0),c.post(route("admin.schools.deactivate",r.school.id),{},{preserveScroll:!0,onSuccess:()=>{c.reload({only:["schools"]}),x(),i(!1)},onError:t=>{i(!1),console.error("Deactivation failed:",t)}})},S=()=>{window.location.href=route("admin.schools.export",a)},A=()=>{i(!0),c.delete(route("admin.schools.destroy",r.school.id),{onFinish:()=>{i(!1),x()}})},v=t=>a.sort!==t?e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):a.direction==="asc"?e.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})});return e.jsxs(_,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Manage Schools"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["Showing ",s.data.length," of ",s.total," schools"]})]}),e.jsxs("button",{onClick:S,className:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring ring-indigo-300 transition-all ease-in-out duration-150",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export CSV"]})]}),children:[e.jsx(L,{title:"Manage Schools"}),e.jsxs("div",{className:"py-6",children:[e.jsx(T,{onApply:p,onReset:f,showDateFilters:!1,showSchoolTypeFilter:!0,showStatusFilter:!0,defaultFilters:a}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>d("school_name"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"School Name"}),v("school_name")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"UDISE"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>d("district"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Location"}),v("district")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"School Type"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>d("created_at"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Registered"}),v("created_at")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Profile"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.data.length>0?s.data.map((t,l)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.from+l}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(m,{href:route("admin.schools.show",t.id),className:"text-sm font-medium text-indigo-600 hover:text-indigo-900",children:t.school_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.udise}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.district?.name||t.district||"N/A"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.zone?.name||t.zone||"N/A"," · ",t.state]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 capitalize",children:t.school_type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(D,{status:t.is_active})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx(m,{href:route("admin.schools.profile",t.id),className:"text-indigo-600 hover:text-indigo-900",children:"Profile"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(m,{href:route("admin.schools.show",t.id),className:"text-indigo-600 hover:text-indigo-900",children:"View"}),t.is_active?e.jsx("button",{onClick:()=>y(t,"deactivate"),className:"text-red-600 hover:text-red-900",children:"Deactivate"}):e.jsx("button",{onClick:()=>y(t,"activate"),className:"text-green-600 hover:text-green-900",children:"Activate"}),e.jsx("button",{onClick:()=>y(t,"delete"),className:"text-red-700 hover:text-red-900 font-semibold",children:"Delete"})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-12 text-center text-sm text-gray-500",children:"No schools found matching your filters."})})})]})}),s.total>s.per_page&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[s.prev_page_url&&e.jsx(m,{href:s.prev_page_url,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),s.next_page_url&&e.jsx(m,{href:s.next_page_url,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:s.from})," to"," ",e.jsx("span",{className:"font-medium",children:s.to})," of"," ",e.jsx("span",{className:"font-medium",children:s.total})," results"]})}),e.jsx("div",{children:e.jsx("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:s.links.map((t,l)=>t.url?e.jsx(m,{href:t.url,className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${t.active?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:b(t.label)},l):e.jsx("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-gray-100 text-sm font-medium text-gray-400",children:b(t.label)},l))})})]})]})]})]}),r.action==="activate"&&e.jsx(N,{isOpen:r.isOpen,onClose:x,onConfirm:k,title:"Activate School",message:`Are you sure you want to activate ${r.school?.school_name}? This will allow the school to access the system again.`,variant:"info",confirmText:"Activate",processing:h}),r.action==="deactivate"&&e.jsx(N,{isOpen:r.isOpen,onClose:x,onConfirm:C,title:"Deactivate School",message:`Are you sure you want to deactivate ${r.school?.school_name}? This will prevent the school from accessing the system. The school's data will be preserved and can be accessed when reactivated.`,variant:"danger",confirmText:"Deactivate",processing:h}),r.action==="delete"&&e.jsx(N,{isOpen:r.isOpen,onClose:x,onConfirm:A,title:"⚠️ Permanently Delete School",message:`Are you ABSOLUTELY sure you want to delete "${r.school?.school_name}"?

This will PERMANENTLY DELETE:
• All daily consumption records
• All rice reports and amount reports
• All configurations and settings
• All bill records
• All historical data

⚠️ THIS ACTION CANNOT BE UNDONE!`,variant:"danger",confirmText:"Yes, Delete Permanently",processing:h})]})}export{V as default};
