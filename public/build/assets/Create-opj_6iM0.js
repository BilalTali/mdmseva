import{u as k,j as e,H as C,L as y}from"./app-DTibhLhK.js";import{A as R}from"./AuthenticatedLayout-C_q-P71k.js";import"./transition-B6XJw7kz.js";import"./AuthLogo-By0jpm9W.js";import"./SupportChatWidget-Dou21Zk3.js";import"./createLucideIcon-CoYzo3AD.js";function $({auth:j,academic_years:f=[],classes:N=[],user_udise:g="",school_name:u="",school_type:v="",existing_statements:x=[],previous_month_data:n=null}){const r=x.length>0,d=r?x[0]:null,h=()=>{const t={primary:["kg","1","2","3","4","5"],middle:["kg","1","2","3","4","5","6","7","8"],secondary:["6","7","8","9","10"],senior_secondary:["6","7","8","9","10","11","12"]}[v]||[];return N.filter(l=>t.includes(l.value))};h();const w=()=>{const s=h();return r?s.map(t=>{const l=x.find(i=>i.class===t.value);return{class:t.value,class_label:t.label,boys:l?l.boys:0,girls:l?l.girls:0}}):n&&n.entries?s.map(t=>{const l=n.entries.find(i=>i.class===t.value);return{class:t.value,class_label:t.label,boys:l?l.boys:0,girls:l?l.girls:0}}):s.map(t=>({class:t.value,class_label:t.label,boys:0,girls:0}))},{data:a,setData:m,post:S,put:_,processing:b,errors:c}=k({date:d?.date||"",udise:g,academic_year:d?.academic_year||"",is_bulk:!0,entries:w()}),p=(s,t,l)=>{const i=[...a.entries];i[s][t]=parseInt(l)||0,m("entries",i)},E=s=>{if(s.preventDefault(),a.entries.filter(l=>l.boys>0||l.girls>0).length===0){alert("Please enter student counts for at least one class");return}({...a},r?_(route("roll-statements.update",d.id),{preserveScroll:!0,onError:l=>{console.error("Update errors:",l)}}):S(route("roll-statements.store"),{preserveScroll:!0,onError:l=>{console.error("Store errors:",l)}}))},o=a.entries.reduce((s,t)=>({boys:s.boys+t.boys,girls:s.girls+t.girls,total:s.total+t.boys+t.girls}),{boys:0,girls:0,total:0});return a.entries.filter(s=>s.boys+s.girls>0).length,e.jsxs(R,{user:j.user,children:[e.jsx(C,{title:r?"Edit Roll Statement":"Create Roll Statement"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-4",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:r?"Edit Roll Statement":"Create Roll Statement"}),u&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[u," â€¢ UDISE: ",g]}),r&&d?.last_updated_at&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.jsx("i",{className:"fas fa-clock mr-1"}),"Last Updated: ",d.last_updated_at,d.updated_by_name&&` by ${d.updated_by_name}`]})]}),e.jsx("div",{className:"flex-grow max-w-2xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:a.date,onChange:s=>m("date",s.target.value),disabled:r,className:`w-full rounded-md shadow-sm border-gray-300 text-sm ${r?"bg-gray-100 cursor-not-allowed":""}`,required:!0}),c.date&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.date})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Academic Year ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:a.academic_year,onChange:s=>m("academic_year",s.target.value),disabled:r,className:`w-full rounded-md shadow-sm border-gray-300 text-sm ${r?"bg-gray-100 cursor-not-allowed":""}`,required:!0,children:[e.jsx("option",{value:"",children:"Select Academic Year"}),f.map(s=>e.jsx("option",{value:s,children:s},s))]}),c.academic_year&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.academic_year})]})]})}),e.jsx(y,{href:route("roll-statements.index"),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm font-medium whitespace-nowrap self-start",children:"View All Records"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Student Enrollment"}),!r&&n&&e.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:["ðŸ“‹ Pre-filled from ",n.month_name]})]}),e.jsx("div",{className:"space-y-2 flex-grow overflow-y-auto",style:{maxHeight:"calc(100vh - 350px)"},children:a.entries.map((s,t)=>e.jsx("div",{className:`border rounded-lg p-2 ${s.boys+s.girls>0?"border-blue-300 bg-blue-50":"border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:s.class_label}),e.jsx("input",{type:"number",placeholder:"Boys",value:s.boys,onChange:l=>p(t,"boys",l.target.value),min:"0",className:"w-full rounded-md shadow-sm border-gray-300 text-sm py-1"}),e.jsx("input",{type:"number",placeholder:"Girls",value:s.girls,onChange:l=>p(t,"girls",l.target.value),min:"0",className:"w-full rounded-md shadow-sm border-gray-300 text-sm py-1"})]})},t))})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(y,{href:route("roll-statements.index"),className:"px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:E,disabled:b||o.total===0,className:"px-6 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Saving...":r?"Update Statement":"Save Statement"})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6 sticky top-6 flex flex-col",style:{maxHeight:"calc(100vh - 200px)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Roll Statement Preview"}),a.academic_year&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:a.academic_year})]}),e.jsx("div",{className:"space-y-2 flex-grow overflow-y-auto",children:a.entries.filter(s=>s.boys+s.girls>0).length>0?a.entries.filter(s=>s.boys+s.girls>0).map((s,t)=>e.jsxs("div",{className:"border rounded-lg p-3 bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.class_label}),e.jsxs("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded font-medium",children:["Total: ",s.boys+s.girls]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded p-2 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Boys"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:s.boys})]}),e.jsxs("div",{className:"bg-white rounded p-2 text-center",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Girls"}),e.jsx("p",{className:"text-lg font-bold text-pink-600",children:s.girls})]})]})]},t)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"No entries yet"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Fill in student counts to see preview"})]})}),a.entries.filter(s=>s.boys+s.girls>0).length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t-2 flex-shrink-0",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium mb-2 uppercase",children:"Grand Total"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Boys"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:o.boys})]}),e.jsxs("div",{className:"text-center border-x border-gray-300",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Girls"}),e.jsx("p",{className:"text-xl font-bold text-pink-600",children:o.girls})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-indigo-600",children:o.total})]})]})]})})]})})]})]})})]})}export{$ as default};
