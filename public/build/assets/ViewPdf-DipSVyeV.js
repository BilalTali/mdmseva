import{r as o,j as e,H as R,a as x}from"./app-DhNoL3JN.js";import{A as S}from"./AuthenticatedLayout-D4HZ-Zjq.js";import{C as P}from"./circle-alert-x7Q2sn-o.js";import{P as F}from"./package-BqBCtS4F.js";import{T as A}from"./trending-up-DmUsnkcP.js";import{C as $}from"./calendar-B1ZLsdFX.js";import{C as D}from"./circle-check-DdyEBvfX.js";import{A as L}from"./arrow-right-BrEMZjV6.js";import{E as p}from"./eye-DHd0bO7j.js";import{c as M}from"./createLucideIcon-B4Gf14wH.js";import{R as B}from"./refresh-cw-BwPZmJKK.js";import{F as I}from"./file-down-DAO3Y7BD.js";import"./transition-Cfg9tJBG.js";import"./AuthLogo-DOO80UpC.js";import"./SupportChatWidget-C2pfx3sn.js";/**
 * @license lucide-react v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],E=M("palette",U);function le({report:s,allReports:y,schoolType:G,schoolInfo:J,currentAvailableStock:j,statistics:c,can_carryforward:u,closing_balance:r,next_month_info:a,flash:O}){const[l,f]=o.useState("bw"),[i,b]=o.useState(s.id),[n,d]=o.useState(!1),N=`/rice-reports/${i}/generate-pdf?theme=${l}&preview=1`,h=[{id:"bw",name:"Black & White",color:"bg-gray-700",preview:"Professional"},{id:"blue",name:"Blue Theme",color:"bg-blue-600",preview:"Classic"},{id:"green",name:"Green Theme",color:"bg-green-600",preview:"Fresh"},{id:"purple",name:"Purple Theme",color:"bg-purple-600",preview:"Modern"}],v=t=>f(t),w=t=>{const m=t.target.value;b(m),x.visit(`/rice-reports/${m}/view-pdf`,{preserveScroll:!0})},k=()=>{const t=`/rice-reports/${i}/generate-pdf?theme=${l}&download=1`;window.open(t,"_blank")},C=()=>{window.open(N,"_blank")},_=()=>{confirm("Are you sure you want to regenerate this report? This will recalculate all data.")&&(d(!0),x.post(`/rice-reports/${i}/regenerate`,{},{onFinish:()=>d(!1)}))},T=()=>{confirm(`Transfer closing balance to ${g(a?.month)} ${a?.year} as opening balance?`)&&(d(!0),x.post(`/rice-reports/${s.id}/carryforward`,{},{onFinish:()=>d(!1)}))},g=t=>["January","February","March","April","May","June","July","August","September","October","November","December"][t-1]||"";return e.jsxs(S,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:["Rice Report - ",s.period]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:_,disabled:n,className:"inline-flex items-center px-4 py-2 bg-yellow-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-yellow-700 disabled:opacity-50",children:[e.jsx(B,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),"Regenerate"]}),e.jsxs("button",{onClick:k,className:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Download PDF"]})]})]}),children:[e.jsx(R,{title:`Rice Report - ${s.period}`}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[c&&e.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg p-6 text-white",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(P,{className:"w-5 h-5 mr-2"}),e.jsx("p",{className:"text-sm font-medium",children:"Live System Statistics (Real-time Data)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"w-8 h-8 mr-3 opacity-80"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Current Available Stock"}),e.jsxs("p",{className:"text-2xl font-bold",children:[j?.toFixed(2)||"0.00"," kg"]}),e.jsx("p",{className:"text-xs opacity-75 mt-1",children:"Live closing balance"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"w-8 h-8 mr-3 opacity-80"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Total Consumed (All Time)"}),e.jsxs("p",{className:"text-2xl font-bold",children:[c.total_rice_consumed?.toFixed(2)||"0.00"," kg"]}),e.jsx("p",{className:"text-xs opacity-75 mt-1",children:"Calculated from daily records"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-8 h-8 mr-3 opacity-80"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-90",children:"Average Daily Consumption"}),e.jsxs("p",{className:"text-2xl font-bold",children:[c.average_daily_consumption?.toFixed(2)||"0.00"," kg"]}),e.jsx("p",{className:"text-xs opacity-75 mt-1",children:"All-time average per day"})]})]})]})]}),u&&r&&a&&e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(D,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-blue-900 mb-2",children:"Transfer Balance to Next Month?"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[e.jsxs("p",{children:["Rice report for ",e.jsx("strong",{children:s.period})," generated successfully!"]}),e.jsxs("div",{className:"bg-white/60 rounded p-3 mt-2",children:[e.jsx("p",{className:"font-medium mb-1",children:"Closing Balance:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:["Primary: ",e.jsxs("strong",{children:[r.primary.toFixed(2)," kg"]})]}),e.jsxs("li",{children:["Upper Primary: ",e.jsxs("strong",{children:[r.upper_primary.toFixed(2)," kg"]})]}),e.jsxs("li",{className:"text-blue-900 font-semibold",children:["Total: ",r.total.toFixed(2)," kg"]})]})]}),e.jsxs("p",{className:"mt-3",children:["Create ",e.jsxs("strong",{children:[g(a.month)," ",a.year]})," rice configuration with this balance as opening stock?"]})]}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsxs("button",{onClick:T,disabled:n,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 font-medium",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Yes, Transfer Balance"]}),e.jsx("a",{href:"/monthly-rice-config/create",className:"inline-flex items-center px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-medium",children:"Create Manually Later"})]})]})]})}),e.jsx("div",{className:"bg-white shadow-sm sm:rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(p,{className:"w-4 h-4 inline mr-2"}),"Select Report"]}),e.jsx("select",{value:i,onChange:w,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:y.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(E,{className:"w-4 h-4 inline mr-2"}),"Select Theme"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:h.map(t=>e.jsxs("button",{onClick:()=>v(t.id),className:`p-3 rounded-lg border-2 transition-all ${l===t.id?"border-indigo-600 shadow-md":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:`w-full h-8 rounded ${t.color} mb-2`}),e.jsx("p",{className:"text-xs font-medium text-gray-700",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.preview})]},t.id))})]})]})}),e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"PDF Preview"}),e.jsxs("span",{className:"text-sm text-indigo-600 font-medium",children:["Theme: ",h.find(t=>t.id===l)?.name]})]}),e.jsxs("div",{className:"border-2 border-dashed border-indigo-200 rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Use the buttons above to pick a theme, then click below to open the live preview in a new browser tab."}),e.jsxs("button",{type:"button",onClick:C,className:"inline-flex items-center px-5 py-2.5 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",children:[e.jsx(p,{className:"w-5 h-5 mr-2"}),"Preview PDF"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"The preview reflects your latest theme selection instantly."})]})]}),e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Section-wise Summary for ",s.period]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Section"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Students"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rice Consumed (kg)"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:"Primary (Class 1-5)"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:s.totals_by_section?.primary?.students||0}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:s.totals_by_section?.primary?.formatted_rice||"0.00 kg"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:"Middle (Class 6-8)"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:s.totals_by_section?.middle?.students||0}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:s.totals_by_section?.middle?.formatted_rice||"0.00 kg"})]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-bold text-gray-900",children:"Grand Total"}),e.jsx("td",{className:"px-6 py-4 text-sm font-bold text-gray-900",children:s.totals_by_section?.grand_total?.students||0}),e.jsx("td",{className:"px-6 py-4 text-sm font-bold text-gray-900",children:s.totals_by_section?.grand_total?.formatted_rice||"0.00 kg"})]})]})]})})]}),e.jsxs("div",{className:"bg-white shadow-sm sm:rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Report Information"}),e.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Report Period"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:s.period})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"School Type"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:s.school_type})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Opening Balance"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.opening_balance," kg"]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Closing Balance"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.closing_balance," kg"]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Total Rice Consumed"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.total_rice_consumed," kg"]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Serving Days"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.total_serving_days," days"]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Average Daily Consumption"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[s.average_daily_consumption," kg"]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Generated On"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(s.created_at).toLocaleString()})]})]})]})]})})]})}export{le as default};
