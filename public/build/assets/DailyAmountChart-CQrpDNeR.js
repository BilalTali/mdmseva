import{j as e}from"./app-CSPInevx.js";import{u as C}from"./ThemeContext-C1bmRLCA.js";import{y as D,z as f}from"./CategoricalChart-Dhv_fpLi.js";import{B as u,a as c}from"./BarChart-Dcsb4PSZ.js";import{C as y,X as j,Y as h}from"./CartesianChart-BKJweIOX.js";import{L as b}from"./Legend-AGNwSfjT.js";import{C as B}from"./tooltipContext-Dos0i4Pb.js";import"./clsx-B-dksMZM.js";import"./index-BV1_LFfs.js";import"./with-selector-8Zs4ZpQl.js";import"./ReactUtils-CnFCdVAr.js";import"./ErrorBarContext-DC5chhuA.js";const R=({data:g=[],schoolType:d="both",dateFormat:x="DD/MM",threshold:n=null,showBreakdown:N=!1})=>{const{theme:v}=C(),l=v==="dark",t={text:l?"#9ca3af":"#374151",grid:l?"#374151":"#e5e7eb",tooltipBg:l?"#1f2937":"#ffffff",tooltipBorder:l?"#374151":"#e5e7eb",tooltipText:l?"#f3f4f6":"#111827",tooltipTextSecondary:l?"#9ca3af":"#6b7280",primary:"#3b82f6",middle:"#8b5cf6",total:"#3b82f6",legendBg:l?"#374151":"#f9fafb"},S=s=>{if(!s)return"";const a=new Date(s),i=a.getDate().toString().padStart(2,"0"),o=(a.getMonth()+1).toString().padStart(2,"0");return x==="DD/MM"?`${i}/${o}`:x==="DD MMM"?`${i} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()]}`:s},r=g.map(s=>({...s,displayDate:S(s.date),amount:parseFloat(s.amount)||0,primary_amount:parseFloat(s.primary_amount)||0,middle_amount:parseFloat(s.middle_amount)||0,pulses:parseFloat(s.pulses)||0,vegetables:parseFloat(s.vegetables)||0,oil:parseFloat(s.oil)||0,salt:parseFloat(s.salt)||0,fuel:parseFloat(s.fuel)||0})),F=d==="primary"||d==="middle",T=d==="middle",k=s=>n?s>n?"#ef4444":"#10b981":t.total,m=({active:s,payload:a,label:i})=>{if(s&&a&&a.length){const o=a[0].payload;return e.jsxs("div",{className:"p-4 rounded-lg shadow-xl border-2",style:{backgroundColor:t.tooltipBg,borderColor:t.tooltipBorder},children:[e.jsxs("p",{className:"font-bold mb-3 pb-2 border-b",style:{color:t.tooltipText,borderColor:t.tooltipBorder},children:["ðŸ“… ",i]}),N&&F&&T?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 text-sm mb-3",children:[e.jsxs("div",{className:"flex justify-between gap-6 p-2 rounded",style:{backgroundColor:l?"rgba(59, 130, 246, 0.2)":"#eff6ff"},children:[e.jsx("span",{className:"font-semibold",style:{color:l?"#93c5fd":"#1d4ed8"},children:"Primary:"}),e.jsxs("span",{className:"font-bold",style:{color:l?"#bfdbfe":"#1e3a8a"},children:["â‚¹",o.primary_amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between gap-6 p-2 rounded",style:{backgroundColor:l?"rgba(139, 92, 246, 0.2)":"#f5f3ff"},children:[e.jsx("span",{className:"font-semibold",style:{color:l?"#c4b5fd":"#6d28d9"},children:"Middle:"}),e.jsxs("span",{className:"font-bold",style:{color:l?"#ddd6fe":"#4c1d95"},children:["â‚¹",o.middle_amount.toFixed(2)]})]})]}),e.jsx("div",{className:"pt-2 border-t",style:{borderColor:t.tooltipBorder},children:e.jsxs("div",{className:"flex justify-between gap-4 font-bold",children:[e.jsx("span",{style:{color:t.tooltipText},children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["â‚¹",o.amount.toFixed(2)]})]})})]}):o.pulses!==void 0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1.5 text-sm mb-2",children:[e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{style:{color:t.tooltipTextSecondary},children:"Pulses:"}),e.jsxs("span",{className:"font-semibold",style:{color:t.tooltipText},children:["â‚¹",o.pulses.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{style:{color:t.tooltipTextSecondary},children:"Vegetables:"}),e.jsxs("span",{className:"font-semibold",style:{color:t.tooltipText},children:["â‚¹",o.vegetables.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{style:{color:t.tooltipTextSecondary},children:"Oil:"}),e.jsxs("span",{className:"font-semibold",style:{color:t.tooltipText},children:["â‚¹",o.oil.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{style:{color:t.tooltipTextSecondary},children:"Salt:"}),e.jsxs("span",{className:"font-semibold",style:{color:t.tooltipText},children:["â‚¹",o.salt.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{style:{color:t.tooltipTextSecondary},children:"Fuel:"}),e.jsxs("span",{className:"font-semibold",style:{color:t.tooltipText},children:["â‚¹",o.fuel.toFixed(2)]})]})]}),e.jsx("div",{className:"pt-2 border-t",style:{borderColor:t.tooltipBorder},children:e.jsxs("div",{className:"flex justify-between gap-4 font-semibold",children:[e.jsx("span",{style:{color:t.tooltipText},children:"Total:"}),e.jsxs("span",{className:"text-blue-600",children:["â‚¹",o.amount.toFixed(2)]})]})})]}):e.jsxs("div",{className:"flex justify-between gap-4 text-sm",children:[e.jsx("span",{style:{color:t.tooltipTextSecondary},children:"Amount Spent:"}),e.jsxs("span",{className:"font-semibold",style:{color:t.tooltipText},children:["â‚¹",o.amount.toFixed(2)]})]}),n&&e.jsxs("p",{className:"text-xs mt-2",style:{color:t.tooltipTextSecondary},children:[o.amount>n?"Above":"Below"," threshold (â‚¹",n,")"]})]})}return null},p=({payload:s})=>e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-4 mt-6 pb-2",children:s.map((a,i)=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full",style:{backgroundColor:t.legendBg},children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a.color}}),e.jsx("span",{className:"text-sm font-medium",style:{color:t.text},children:a.value})]},i))});return!r||r.length===0?null:e.jsx(D,{width:"100%",height:"100%",children:r[0]?.primary_amount!==void 0&&r[0]?.middle_amount!==void 0?e.jsxs(u,{data:r,margin:{top:10,right:30,left:20,bottom:60},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:t.grid,vertical:!1}),e.jsx(j,{dataKey:"displayDate",stroke:t.text,style:{fontSize:"12px",fontWeight:"500"},angle:-45,textAnchor:"end",height:80,tick:{fill:t.text}}),e.jsx(h,{stroke:t.text,style:{fontSize:"12px",fontWeight:"500"},tick:{fill:t.text},label:{value:"Amount (â‚¹)",angle:-90,position:"insideLeft",style:{fontSize:"13px",fill:t.text,fontWeight:"600"}}}),e.jsx(f,{content:e.jsx(m,{})}),e.jsx(b,{content:e.jsx(p,{})}),e.jsx(c,{dataKey:"primary_amount",fill:t.primary,name:"Primary Spending",radius:[4,4,0,0],maxBarSize:40}),e.jsx(c,{dataKey:"middle_amount",fill:t.middle,name:"Middle Spending",radius:[4,4,0,0],maxBarSize:40})]}):e.jsxs(u,{data:r,margin:{top:10,right:30,left:20,bottom:60},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:t.grid,vertical:!1}),e.jsx(j,{dataKey:"displayDate",stroke:t.text,style:{fontSize:"12px",fontWeight:"500"},angle:-45,textAnchor:"end",height:80,tick:{fill:t.text}}),e.jsx(h,{stroke:t.text,style:{fontSize:"12px",fontWeight:"500"},tick:{fill:t.text},label:{value:"Amount (â‚¹)",angle:-90,position:"insideLeft",style:{fontSize:"13px",fill:t.text,fontWeight:"600"}}}),e.jsx(f,{content:e.jsx(m,{})}),e.jsx(b,{content:e.jsx(p,{})}),e.jsx(c,{dataKey:"amount",name:"Daily Expenditure",radius:[8,8,0,0],maxBarSize:60,children:r.map((s,a)=>e.jsx(B,{fill:k(s.amount)},`cell-${a}`))})]})})};export{R as default};
